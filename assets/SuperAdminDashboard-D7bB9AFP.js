import{j as e,a9 as f,aa as G,ab as Y,ac as z,ad as _,ae as b,af as q,ag as D,r as h,ah as A,ai as P,aj as w,ak as N,z as le,al as re,am as ne,W as ie,I as ce,an as V}from"./common-vendor-Dm1O5F_f.js";import{d as se}from"./index-D5f3LA8Q.js";import{r as te,f as de,d as oe}from"./firebase-vendor-DMyrRdrZ.js";import{C as T,a as R,b as F,d as $}from"./card-LNUWDAdH.js";import{S as W,a as X,b as J,c as Q,d as E}from"./select-1Mx02fKa.js";import{c as xe,d as me,T as Z,a as C,e as he,b as S}from"./table-BlATw8c5.js";import ue from"./Dashboard-2tA42xN4.js";import"./input-B4qfIMTe.js";const je=({campData:x})=>e.jsxs(T,{className:"md:col-span-2 bg-white shadow-lg border-blue-100",children:[e.jsxs(R,{className:"border-b border-blue-50",children:[e.jsx(F,{className:"text-xl font-semibold text-blue-800",children:"Last 50 Completed Camps Units Sold"}),e.jsx("p",{className:"text-sm text-pink-500",children:"Performance overview of recent camps"})]}),e.jsx($,{className:"h-96 pt-6",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(G,{data:x,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"blueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#2563EB",stopOpacity:1}),e.jsx("stop",{offset:"50%",stopColor:"#3B82F6",stopOpacity:.9}),e.jsx("stop",{offset:"100%",stopColor:"#60A5FA",stopOpacity:.8})]}),e.jsx("filter",{id:"shadow",children:e.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.2"})})]}),e.jsx(Y,{strokeDasharray:"3 3",vertical:!1,className:"stroke-blue-100"}),e.jsx(z,{dataKey:"name",tick:{fill:"#1e40af",fontSize:11},tickLine:{stroke:"#93c5fd"},axisLine:{stroke:"#93c5fd"},dy:5,interval:4}),e.jsx(_,{tick:{fill:"#1e40af",fontSize:11},tickLine:{stroke:"#93c5fd"},axisLine:{stroke:"#93c5fd"},dx:-5}),e.jsx(b,{content:({active:i,payload:l})=>{if(i&&l&&l.length){const c=l[0].payload.isSuccessful;return e.jsxs("div",{className:`
                      p-4 rounded-lg shadow-lg border-2
                      ${c?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"}
                    `,children:[e.jsx("p",{className:"font-medium text-blue-900",children:`Camp Code: ${l[0].payload.campCode}`}),e.jsx("p",{className:`text-base ${c?"text-green-600":"text-blue-600"}`,children:`Units Sold: ${l[0].value}`}),e.jsx("p",{className:`text-sm ${c?"text-green-500":"text-blue-500"}`,children:c?"✨ Target Achieved":"Target Pending"})]})}return null},cursor:{fill:"rgba(59, 130, 246, 0.05)"}}),e.jsx(q,{dataKey:"unitsSold",name:"Units Sold",radius:[8,8,0,0],className:"transition-all duration-300",children:x.map((i,l)=>e.jsx(D,{fill:"url(#blueGradient)",filter:"url(#shadow)",className:"transition-all duration-300 cursor-pointer hover:opacity-90"},`cell-${l}`))}),e.jsx("text",{x:"50%",y:10,textAnchor:"middle",className:"text-xs fill-pink-400",children:"Target: 35 units"})]})})})]}),pe=({campData:x})=>e.jsxs(T,{className:"md:col-span-2 mt-6",children:[e.jsx(R,{children:e.jsx(F,{children:"Detailed Camp Information"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(xe,{children:[e.jsx(me,{children:e.jsxs(Z,{children:[e.jsx(C,{children:"Camp Code"}),e.jsx(C,{children:"Nurse Name"}),e.jsx(C,{className:"text-right",children:"Units Sold"}),e.jsx(C,{className:"text-right",children:"Marketing Expense"}),e.jsx(C,{className:"text-right",children:"Operational Expense"}),e.jsx(C,{children:"Report Status"})]})}),e.jsx(he,{children:x.map(i=>{var l;return e.jsxs(Z,{children:[e.jsx(S,{className:"font-medium",children:i.campCode}),e.jsx(S,{children:i.nurseName}),e.jsx(S,{className:"text-right",children:i.unitsSold}),e.jsxs(S,{className:"text-right",children:["₹",i.marketingExpense.toLocaleString()]}),e.jsxs(S,{className:"text-right",children:["₹",i.operationalExpense.toLocaleString()]}),e.jsx(S,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium 
                      ${((l=i.reportStatus)==null?void 0:l.toLowerCase())==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:i.reportStatus})})]},i.campCode)})})]})})})]}),y=({title:x,value:i,description:l})=>e.jsxs(T,{className:"bg-white",children:[e.jsx(R,{className:"pb-2",children:e.jsx(F,{className:"text-sm font-medium text-gray-600",children:x})}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i}),l&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l})]})]}),ee=["#0088FE","#00C49F","#FFBB28"];function ge(){const[x,i]=h.useState([]),[l,c]=h.useState("all"),[v,M]=h.useState("all"),[K,L]=h.useState(!0);h.useEffect(()=>{(async()=>{L(!0);const a=te(se,"healthCamps");de(a,j=>{const n=j.val();if(n){const p=Object.entries(n).map(([g,o])=>({id:g,...o,date:new Date(o.date),unitsSold:parseInt(o.unitsSold||0),revenue:parseFloat(o.revenue||0),marketingExpense:parseFloat(o.marketingExpense||0),operationalExpense:parseFloat(o.operationalExpense||0),amountPaidToFinance:parseFloat(o.amountPaidToFinance||0),state:o.state||"",district:o.district||"",nurseName:o.nurseName||"",reportStatus:o.reportStatus||"Pending",campCode:o.campCode||"",status:o.status||""}));i(p)}L(!1)})})()},[]);const m=(()=>{const t=new Date,a=t.getMonth(),j=t.getFullYear(),n=x.filter(s=>!(l!=="all"&&s.state.toLowerCase()!==l.toLowerCase()||v!=="all"&&s.district.toLowerCase()!==v.toLowerCase())),p=n.filter(s=>{const r=s.date;return r.getMonth()===a&&r.getFullYear()===j}),g=[{name:"Below 25",value:n.filter(s=>s.unitsSold<25).length},{name:"25-34",value:n.filter(s=>s.unitsSold>=25&&s.unitsSold<35).length},{name:"35 & Above",value:n.filter(s=>s.unitsSold>=35).length}],o=[{name:"Successful",value:n.filter(s=>s.unitsSold>=35).length},{name:"Unsuccessful",value:n.filter(s=>s.unitsSold<35).length}],U=[...n].filter(s=>{var r;return((r=s.status)==null?void 0:r.toLowerCase())==="completed"}).sort((s,r)=>r.date-s.date).slice(0,50).reverse().map((s,r)=>({name:`Camp ${r+1}`,unitsSold:s.unitsSold,isSuccessful:s.unitsSold>=35,campCode:s.campCode,nurseName:s.nurseName,marketingExpense:s.marketingExpense,operationalExpense:s.operationalExpense,reportStatus:s.reportStatus})),H=n.length>0?(n.reduce((s,r)=>s+r.unitsSold,0)/n.length).toFixed(1):0,I=n.length>0?(n.filter(s=>s.unitsSold>=35).length/n.length*100).toFixed(1):0;return{totalCamps:n.length,totalTests:n.reduce((s,r)=>s+r.unitsSold,0),totalRevenue:n.reduce((s,r)=>s+r.revenue,0),currentMonthCamps:p.length,currentMonthTests:p.reduce((s,r)=>s+r.unitsSold,0),currentMonthRevenue:p.reduce((s,r)=>s+r.revenue,0),avgUnitsSold:H,successRate:I,testRangesData:g,successRateData:o,last50Camps:U}})(),B=[...new Set(x.map(t=>t.state))].filter(Boolean),O=[...new Set(x.filter(t=>l==="all"||t.state.toLowerCase()===l.toLowerCase()).map(t=>t.district))].filter(Boolean),d=({active:t,payload:a})=>t&&a&&a.length?e.jsxs("div",{className:"bg-white p-2 border rounded shadow",children:[e.jsx("p",{children:`${a[0].name}: ${a[0].value} camps`}),e.jsx("p",{children:`(${(a[0].value/m.totalCamps*100).toFixed(1)}%)`})]}):null;return K?e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx("div",{className:"text-lg",children:"Loading dashboard data..."})}):e.jsxs("div",{className:"flex min-h-screen flex-col space-y-6 p-8 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Health Camp Analytics"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(W,{value:l,onValueChange:c,children:[e.jsx(X,{className:"w-44",children:e.jsx(J,{placeholder:"Select State"})}),e.jsxs(Q,{children:[e.jsx(E,{value:"all",children:"All States"}),B.map(t=>e.jsx(E,{value:t,children:t},t))]})]}),e.jsxs(W,{value:v,onValueChange:M,children:[e.jsx(X,{className:"w-44",children:e.jsx(J,{placeholder:"Select District"})}),e.jsxs(Q,{children:[e.jsx(E,{value:"all",children:"All Districts"}),O.map(t=>e.jsx(E,{value:t,children:t},t))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(y,{title:"Total Camps (Since Inception)",value:m.totalCamps,description:"Total number of health camps conducted"}),e.jsx(y,{title:"Total Units Sold",value:m.totalTests,description:"Cumulative units sold across all camps"}),e.jsx(y,{title:"Total Revenue",value:`₹${m.totalRevenue.toLocaleString()}`,description:"Total revenue generated from all camps"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(y,{title:"Current Month Camps",value:m.currentMonthCamps,description:"Number of camps this month"}),e.jsx(y,{title:"Average Units per Camp",value:m.avgUnitsSold,description:"Average units sold per camp"}),e.jsx(y,{title:"Success Rate",value:`${m.successRate}%`,description:"Percentage of camps achieving target"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(T,{children:[e.jsx(R,{children:e.jsx(F,{children:"Units Sold Distribution"})}),e.jsx($,{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(A,{children:[e.jsx(P,{data:m.testRangesData,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:({name:t,percent:a})=>`${t} (${(a*100).toFixed(1)}%)`,children:m.testRangesData.map((t,a)=>e.jsx(D,{fill:ee[a]},`cell-${a}`))}),e.jsx(b,{content:e.jsx(d,{})}),e.jsx(w,{})]})})})]}),e.jsxs(T,{children:[e.jsx(R,{children:e.jsx(F,{children:"Camp Success Rate"})}),e.jsx($,{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(A,{children:[e.jsx(P,{data:m.successRateData,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:({name:t,percent:a})=>`${t} (${(a*100).toFixed(1)}%)`,children:m.successRateData.map((t,a)=>e.jsx(D,{fill:ee[a]},`cell-${a}`))}),e.jsx(b,{content:e.jsx(d,{})}),e.jsx(w,{})]})})})]}),e.jsx(je,{campData:m.last50Camps})]}),e.jsx(pe,{campData:m.last50Camps})]})}const k=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"];function fe(){const[x,i]=h.useState(!0),[l,c]=h.useState(""),[v,M]=h.useState([]),[K,L]=h.useState("all"),[u,m]=h.useState({totalTests:0,totalRevenue:0,pendingReports:0,completedTests:0,testDistribution:[],revenueByTest:[],statusDistribution:[],partnerDistribution:[]});h.useEffect(()=>{(async()=>{i(!0),c("");try{const t=te(se,"testEntries"),a=await oe(t);if(a.exists()){const j=Object.values(a.val());M(j),B(j,"all")}else c("No test data available")}catch(t){c("Error fetching data: "+t.message)}i(!1)})()},[]);const B=(d,t)=>{let a=d;t!=="all"&&(a=d.filter(s=>s.testName===t));const j=a.length,n=N.sumBy(a,s=>Number(s.price)||0),p=a.filter(s=>!s.reportStatus||s.reportStatus==="not_submitted").length,g=a.filter(s=>s.vendorStatus==="completed"&&s.reportStatus==="submitted").length,o=N(a).groupBy("testName").map((s,r)=>({name:r,count:s.length})).value(),U=N(a).groupBy("testName").map((s,r)=>({name:r,revenue:N.sumBy(s,ae=>Number(ae.price)||0)})).value(),H=[{name:"Completed",value:g},{name:"Pending Reports",value:p},{name:"In Progress",value:j-g-p}],I=N(a).groupBy(s=>s.hasPartner?"Partner":"Direct").map((s,r)=>({name:r,value:s.length})).value();m({totalTests:j,totalRevenue:n,pendingReports:p,completedTests:g,testDistribution:o,revenueByTest:U,statusDistribution:H,partnerDistribution:I})},O=d=>{const t=d.target.value;L(t),B(v,t)};return x?e.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Home Test Dashboard"}),e.jsxs("select",{value:K,onChange:O,className:"rounded-lg border-gray-300",children:[e.jsx("option",{value:"all",children:"All Tests"}),N(v).map("testName").uniq().filter(Boolean).sort().map(d=>e.jsx("option",{value:d,children:d},d)).value()]})]})}),l&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700",children:l})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"w-10 h-10 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Tests"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:u.totalTests})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"w-10 h-10 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["₹",u.totalRevenue]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-10 h-10 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Reports"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:u.pendingReports})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-10 h-10 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed Tests"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:u.completedTests})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Test Distribution"}),e.jsx("div",{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(G,{data:u.testDistribution,children:[e.jsx(Y,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name"}),e.jsx(_,{}),e.jsx(b,{}),e.jsx(w,{}),e.jsx(q,{dataKey:"count",fill:"#0088FE",name:"Number of Tests"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue by Test"}),e.jsx("div",{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(G,{data:u.revenueByTest,children:[e.jsx(Y,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name"}),e.jsx(_,{}),e.jsx(b,{}),e.jsx(w,{}),e.jsx(q,{dataKey:"revenue",fill:"#00C49F",name:"Revenue (₹)"})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status Distribution"}),e.jsx("div",{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(A,{children:[e.jsx(P,{data:u.statusDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:t})=>`${d} (${(t*100).toFixed(0)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:u.statusDistribution.map((d,t)=>e.jsx(D,{fill:k[t%k.length]},`cell-${t}`))}),e.jsx(b,{}),e.jsx(w,{})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Partner vs Direct Tests"}),e.jsx("div",{className:"h-80",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(A,{children:[e.jsx(P,{data:u.partnerDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:t})=>`${d} (${(t*100).toFixed(0)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:u.partnerDistribution.map((d,t)=>e.jsx(D,{fill:k[t%k.length]},`cell-${t}`))}),e.jsx(b,{}),e.jsx(w,{})]})})})]})]})]})})}const Te=()=>{const[x,i]=h.useState("healthcamp"),l=[{id:"healthcamp",name:"Health Camp Dashboard",icon:V,component:ge},{id:"hometest",name:"Individual Tests",icon:V,component:fe},{id:"DataBase",name:"DataBase",icon:V,component:ue}];return e.jsx("div",{className:"min-h-screen bg-gray-100 py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"SuperAdmin Dashboard"})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8","aria-label":"Tabs",children:l.map(c=>e.jsxs("button",{onClick:()=>i(c.id),className:`
                    flex items-center gap-2 px-3 py-2 text-sm font-medium border-b-2 
                    ${x===c.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                  `,children:[e.jsx(c.icon,{className:"w-5 h-5"}),c.name]},c.id))})})}),e.jsx("div",{className:"mt-6",children:l.map(c=>x===c.id&&e.jsx("div",{children:e.jsx(c.component,{})},c.id))})]})})};export{Te as default};
