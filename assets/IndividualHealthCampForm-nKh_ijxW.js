import{r as a,j as e,l as ie,m as ye,n as ue,y as Te,F as _,z as $,E as pe,u as xe,G as je,U as z,I as W,J as he,K as Ne,Q as Se,W as Ce,X as ve,Y as me,t as we,Z as Ae,$ as Pe}from"./common-vendor-Dm1O5F_f.js";import{d as H,u as Q}from"./index-D5f3LA8Q.js";import{r as V,f as K,h as J,u as ce,p as Fe}from"./firebase-vendor-DMyrRdrZ.js";import{C as Z,a as ee,b as te,d as se}from"./card-LNUWDAdH.js";import{d as Ee,e as De,f as Re,g as Le}from"./tooltip-JWNWVOX-.js";const ne=({onSearch:x,onSelect:b,testEntries:d,disabled:y=!1,loading:h=!1})=>{const[t,r]=a.useState(""),[T,j]=a.useState(!1),[C,v]=a.useState([]);a.useEffect(()=>{f(t)},[t,d]);const f=s=>{if(!s||s.length<3){v([]);return}const S=d.filter(u=>u.testCode&&u.testCode.toLowerCase().includes(s.toLowerCase())||u.name&&u.name.toLowerCase().includes(s.toLowerCase())||u.bookingId&&u.bookingId.toLowerCase().includes(s.toLowerCase()));v(S.slice(0,5))},n=s=>{const S=s.target.value;r(S),j(!0),S.length>=7&&(x==null||x(S))},N=s=>{r(s.testCode),j(!1),b==null||b(s)};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ie,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:t,onChange:n,onFocus:()=>j(!0),disabled:y,placeholder:"Search by Test Code, Name, or ID",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-100"})]}),T&&C.length>0&&e.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-96 rounded-md overflow-auto ring-1 ring-black ring-opacity-5",children:C.map(s=>e.jsx("div",{onClick:()=>N(s),className:"cursor-pointer select-none relative p-3 hover:bg-indigo-50 border-b border-gray-100 last:border-0",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.testCode}),e.jsx("span",{className:"text-sm text-gray-600",children:s.name}),e.jsx("span",{className:"text-xs text-gray-500",children:s.bookingId}),s.paymentStatus&&e.jsxs("span",{className:`text-xs capitalize ${s.paymentStatus==="completed"?"text-green-600":s.paymentStatus==="failed"?"text-red-600":"text-yellow-600"}`,children:["Payment: ",s.paymentStatus]})]})},s.id||s.testCode))})]})},ae=({status:x,className:b=""})=>{const d=x||"pending",y=()=>{switch(d.toLowerCase()){case"completed":case"submitted":case"sent":return"bg-green-100 text-green-800 border border-green-200";case"pending":case"not_completed":case"not_submitted":case"not_sent":return"bg-yellow-100 text-yellow-800 border border-yellow-200";case"failed":return"bg-red-100 text-red-800 border border-red-200";default:return"bg-gray-100 text-gray-800 border border-gray-200"}},h=()=>d==="not_completed"||d==="not_submitted"||d==="not_sent"||d==="pending"?"Pending":d.charAt(0).toUpperCase()+d.slice(1).toLowerCase();return e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${y()} ${b}`,children:h()})},le=({activeContext:x,onTestClick:b})=>{const[d,y]=a.useState([]),[h,t]=a.useState(!0),[r,T]=a.useState(null),[j,C]=a.useState(!0),[v,f]=a.useState(!1);a.useEffect(()=>{const i=V(H,"testEntries"),I=K(i,A=>{try{if(A.exists()){const p=Object.entries(A.val()).map(([w,P])=>({id:w,...P})).sort((w,P)=>{var B,o;return new Date(((B=P.metadata)==null?void 0:B.createdAt)||0)-new Date(((o=w.metadata)==null?void 0:o.createdAt)||0)});y(p)}else y([]);t(!1)}catch(p){T("Failed to fetch tests: "+p.message),t(!1)}});return()=>J(i,"value",I)},[]);const n={incomplete:d.filter(i=>!i.paymentStatus||i.paymentStatus!=="completed"),pendingVendor:d.filter(i=>i.paymentStatus==="completed"&&(!i.vendorStatus||i.vendorStatus!=="completed")),pendingReport:d.filter(i=>i.paymentStatus==="completed"&&i.vendorStatus==="completed"&&(!i.reportStatus||i.reportStatus!=="submitted")),completed:d.filter(i=>i.paymentStatus==="completed"&&i.vendorStatus==="completed"&&i.reportStatus==="submitted")},N=({tests:i})=>{const I=v?i:i.slice(0,5);return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"relative rounded-md shadow",children:e.jsx("div",{className:"overflow-y-auto max-h-96",children:e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map(A=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>b==null?void 0:b(A),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:A.testCode})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-500",children:A.mobileNo})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(ae,{status:A.paymentStatus})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(ae,{status:A.vendorStatus})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(ae,{status:A.reportStatus})})]},A.id))})]})})}),i.length>5&&e.jsx("button",{onClick:()=>f(!v),className:"self-center px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800",children:v?"Show Less":`Show All (${i.length})`})]})},s=()=>{switch(x){case"vendor-check":return["pendingVendor","pendingReport"];case"report-status":return["pendingReport","completed"];default:return["incomplete","pendingVendor"]}},S=()=>{switch(x){case"vendor-check":return"pendingVendor";case"report-status":return"pendingReport";default:return"incomplete"}},u={incomplete:{label:"Pending Payments",icon:Te},pendingVendor:{label:"Pending Vendor Booking",icon:_},pendingReport:{label:"Pending Report",icon:$},completed:{label:"Completed",icon:pe}};return h?e.jsxs(Z,{className:"w-full",children:[e.jsx(ee,{children:e.jsx(te,{children:"Test Entry Workflow Status"})}),e.jsx(se,{children:e.jsx("div",{className:"flex justify-center items-center h-48",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})})]}):r?e.jsxs(Z,{className:"w-full",children:[e.jsx(ee,{children:e.jsx(te,{children:"Test Entry Workflow Status"})}),e.jsx(se,{children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:r})})})})})]}):e.jsxs(Z,{className:"w-full",children:[e.jsxs(ee,{className:"flex flex-row items-center justify-between",children:[e.jsx(te,{children:"Test Entry Workflow Status"}),e.jsx("button",{onClick:()=>C(!j),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":j?"Collapse panel":"Expand panel",children:j?e.jsx(ye,{className:"w-5 h-5 text-gray-600"}):e.jsx(ue,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx(se,{children:j&&e.jsxs(Ee,{defaultValue:S(),className:"w-full",children:[e.jsx(De,{className:"mb-4 grid w-full",style:{gridTemplateColumns:`repeat(${s().length}, 1fr)`},children:s().map(i=>{const I=u[i].icon;return e.jsxs(Re,{value:i,className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),u[i].label," (",n[i].length,")"]},i)})}),s().map(i=>e.jsx(Le,{value:i,children:n[i].length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No ",u[i].label.toLowerCase()," test entries found"]}):e.jsx(N,{tests:n[i]})},i))]})})]})},re={"Creatinine Test":{price:120,code:"CRE"},"Glucose Random Test":{price:90,code:"GRT"},"Estradiol Test (E2)":{price:480,code:"EST"},"Reducing Substances, Paediatric Urine Test":{price:150,code:"RSU"},"SGOT / AST Test":{price:150,code:"AST"},"Lactate Dehydrogenase (LDH), Serum Test":{price:260,code:"LDH"},"HCG Tumor Marker (Cancer) Test":{price:570,code:"HCG"},"TSH 3rd Generation Test":{price:190,code:"TSH"},"Urine Glucose Fasting Test":{price:90,code:"UGF"},"HIV 1&2 Antibodies Test by CMIA Method":{price:420,code:"HIV"},"Hemoglobin & Hematocrit Test":{price:160,code:"HHT"},"Adenosine Deaminase (ADA) Test, Serum":{price:520,code:"ADA"},"CRP Test (C Reactive Protein Test)":{price:350,code:"CRP"},"Glucose Fasting Test":{price:90,code:"GFT"},"Blood Urea Test":{price:110,code:"BUT"},"Glucose Challenge Test (GCT)- 50 Grams Of Glucose":{price:90,code:"GCT"},"Urine Sugar Random Test":{price:90,code:"USR"},"Stool for Hanging Drop preparation Test":{price:220,code:"SHD"},"Albumin Test":{price:130,code:"ALB"},"Calcium Test":{price:170,code:"CAL"},"Iron Studies Test":{price:480,code:"IST"},"Cytology For Malignant Cells Test":{price:180,code:"CMC"},"Hepatitis C antibody (HCV) Test - Rapid card":{price:220,code:"HCV"},"Hemodialysis Water Culture":{price:920,code:"HWC"},"Stool pH & Reducing Substances Test":{price:130,code:"SPH"},"Pancreatitis Lipase Test":{price:550,code:"PLT"},"Thyroid Profile Free Test":{price:480,code:"TPF"},"Albert Stain Test (Diphtheria)":{price:220,code:"AST"},"Prothrombin time (pt) Test":{price:310,code:"PTT"},"Absolute Eosinophil Count (AEC) Test":{price:130,code:"AEC"},"Vitamin D Test":{price:570,code:"VDT"},"Rheumatoid Factor (RA) Quantitative Test":{price:350,code:"RAF"},"Urine Culture Test":{price:610,code:"UCT"},"Urine Glucose PP Test":{price:90,code:"UGP"},"HDL Cholesterol Direct Test":{price:230,code:"HDL"},"HIV Antibody, Rapid Card Test":{price:350,code:"HAR"},"Gram Stain Test":{price:260,code:"GST"},"Potassium, Spot Urine Test":{price:220,code:"PSU"},"Pancreatitis Amylase Test":{price:350,code:"PAT"},"Complete Blood Count (CBC) Test":{price:260,code:"CBC"},"Stool Routine & Microscopic Examination":{price:110,code:"SRM"},"Acid Fast Bacilli (AFB) Test (3 Samples)":{price:180,code:"AFB"},"Iron Test":{price:220,code:"IRN"},"Cholesterol Profile":{price:310,code:"CHP"},"Calcium Ionised Serum Test":{price:440,code:"CIS"},"Creatinine Spot Urine Test":{price:220,code:"CSU"},"Liver Function Test (LFT)":{price:350,code:"LFT"},"FT3 (Free Triiodothyronine 3) Test":{price:260,code:"FT3"},"Reticulocyte Count Test":{price:260,code:"RCT"},"Urine Bile Salt & Bile Pigments Test":{price:90,code:"UBS"},"Pericardial Fluid Analysis Test":{price:180,code:"PFA"},"Triglycerides Test":{price:170,code:"TGT"},"Microalbuminuria 24Hrs Urine Test":{price:480,code:"MAU"},"Total Protein Test":{price:110,code:"TPT"},"Magnesium 24 Hrs Urine Test":{price:480,code:"MGU"},"Absolute Neutrophil Count (ANC) Test":{price:140,code:"ANC"},"WIDAL Test By Tube Agglutination":{price:180,code:"WTA"},"Albumin Test by Spot Urine":{price:90,code:"ASU"},"Vitamin B12 Test":{price:480,code:"VB12"},"Acetone Urine (Qualitative) Test":{price:310,code:"AUQ"},"Absolute Lymphocyte Count Blood Test":{price:150,code:"ALC"},"Creatinine Body Fluid Test":{price:220,code:"CBF"},"Microalbuminuria Spot Urine Test":{price:480,code:"MSU"},"Total Protein & Albumin/globulin (ag) Ratio Test":{price:130,code:"TPA"},"Uric Acid Test":{price:140,code:"UAT"},"Uric Acid, Spot urine Test":{price:240,code:"UAS"},"Synovial/Joint Fluid Analysis Test":{price:180,code:"SFA"},"Ferritin Test":{price:350,code:"FER"},"Chloride, Urine Test":{price:170,code:"CLU"},"Follicle Stimulating Hormone FSH Test":{price:440,code:"FSH"},"CBC with PS Test":{price:260,code:"CPS"},"Urine Calcium & Creatinine Ratio Test":{price:150,code:"UCR"},"Electrolytes (Na/K/Cl), Urine Test":{price:310,code:"ELU"},"PAP (Papanicolaou) Smear Test":{price:440,code:"PAP"},"Kidney Function Test (KFT)":{price:350,code:"KFT"},"Absolute Basophils Count Blood Test":{price:150,code:"ABC"},"HBA1C Test":{price:260,code:"HBA"},"Typhoid Test IGM Test":{price:350,code:"TTI"},"Total T4 (Thyroxine) Test":{price:180,code:"TT4"},"Cholesterol Total Body Fluid Test":{price:220,code:"CTB"},"Creatine Kinase MB Test":{price:350,code:"CKM"},"Lipid Profile Test":{price:350,code:"LPT"},"Ascitic Fluid Analysis Test":{price:180,code:"AFA"},"Stool Culture Test":{price:660,code:"SCT"},"Thyroid Profile Test":{price:260,code:"TPT"},"Creatine Phosphokinase (CPK) Test":{price:220,code:"CPK"},"Sickling Test":{price:240,code:"SIC"},"Blood Group Test":{price:120,code:"BGT"},"Serum Ascites Albumin Gradient (SAAG) Test":{price:130,code:"SAG"},"Phosphorus Spot Urine Test":{price:150,code:"PSU"},"VDRL Test CSF":{price:70,code:"VTC"},"Bilirubin (Total, Direct & Indirect) Test":{price:170,code:"BIL"},"Cerebrospinal Fluid (CSF) Analysis Test":{price:180,code:"CSF"},"Blood Urea Nitrogen (BUN) Test":{price:130,code:"BUN"},"Electrolytes (Na/K/Cl) Test":{price:260,code:"ELE"},"Gamma-Glutamyl Transferase Test (GGT)":{price:230,code:"GGT"},"Absolute Granulocyte Count Blood Test":{price:150,code:"AGC"},"Urine Routine & Microscopic Examination Test":{price:170,code:"URM"},"DLC (Differential Leucocyte Count) Test":{price:130,code:"DLC"},"Glucose Post Prandial Test":{price:90,code:"GPP"},"Glucose Tolerance Test (GTT 3)":{price:660,code:"GT3"},"Albumin/Creatinine Ratio, Spot Urine Test":{price:460,code:"ACR"},"Protein & Creatinine Ratio Urine Test":{price:260,code:"PCR"},"Cell Count, Body Fluid Test":{price:220,code:"CCB"},"Typhoid Test IGG & IGM":{price:390,code:"TGM"},"Miscellaneous Fluid Analysis Test":{price:180,code:"MFA"},"AFB Stain Test (Acid Fast Bacilli)":{price:190,code:"ASB"},"Total T3 (Triiodothyronine) Test":{price:180,code:"TT3"},"TLC (Total Leucocyte Count) Test":{price:100,code:"TLC"},"Magnesium Test":{price:260,code:"MGT"},"SGPT / ALT Test":{price:150,code:"ALT"},"Anti Streptolysin O (ASO), Quantitative Test":{price:480,code:"ASO"},"Troponin I, Rapid Card Test":{price:1180,code:"TIC"},"Haemoglobin (Hb) Test":{price:100,code:"HBT"},"Direct Coombs Test (DCT), Whole Blood EDTA Test":{price:390,code:"DCT"},"Testosterone Total Test":{price:340,code:"TTT"},"Malaria Antigen Detection Test (Rapid)":{price:510,code:"MAD"},"Urine Pregnancy Test (UPT)":{price:80,code:"UPT"},"Bilirubin Total Test":{price:120,code:"BTT"},"Alkaline Phosphatase (ALP) Test":{price:130,code:"ALP"},"Platelet Count Test":{price:40,code:"PLT"},"Cholesterol Test":{price:130,code:"CHT"},"FT4 (Free Thyroxine 4) Test":{price:260,code:"FT4"},"Bilirubin Direct Test":{price:120,code:"BDT"},"TLC & DLC Test":{price:130,code:"TDT"},"VDRL Test":{price:200,code:"VDT"},"Pleural Fluid Analysis Test":{price:180,code:"PFA"},"Bleeding Time (BT) & Clotting Time (CT) Test":{price:90,code:"BCT"},"Peripheral Blood Smear Test":{price:130,code:"PBS"},"Sodium Test":{price:130,code:"SOD"},"LDL Cholesterol Direct Test":{price:260,code:"LDL"},"Adenosine Deaminase (ADA) Test Fluid":{price:660,code:"ADF"},"Potassium Test":{price:130,code:"POT"},"Hepatitis B Surface Antigen (HBsAg) Rapid Card Test":{price:310,code:"HBS"},"Stool Occult Blood Test":{price:120,code:"SOB"},"Prolactin Test (PRL)":{price:480,code:"PRL"},"Treponema pallidium hemagglutination assay (tpha) Test":{price:240,code:"TPH"},"Absolute Monocyte Count Blood Test":{price:150,code:"AMC"},"ESR Test":{price:100,code:"ESR"},"Fine Needle Aspiration Cytology (FNAC) Test":{price:310,code:"FNA"},"India Ink Test":{price:150,code:"IIT"},"Liver Function Extended Panel":{price:520,code:"LFE"},"Haemogram (CBC+ESR)":{price:350,code:"HCE"},"G6PD, Qualitative (Glucose-6-Phosphate Dehydrogenase) Test":{price:660,code:"G6P"},"Microfilaria Detection Test":{price:350,code:"MDT"},"Glucose Challenge Test (GCT)- 75 Grams Of Glucose":{price:90,code:"GC7"},"Protein Spot Urine Test":{price:220,code:"PSU"},"Albumin - Fluid Test":{price:110,code:"AFT"},"Progesterone Test":{price:440,code:"PGT"},"WIDAL Test By Slide Agglutination":{price:110,code:"WTS"},"Lipid Profile Direct":{price:390,code:"LPD"},"Sodium, Spot Urine Test":{price:190,code:"SSU"},"Estimated Glomerular Filtration Rate (eGFR) Test":{price:160,code:"EGF"},"Malaria Parasite Test (MP) Smear":{price:110,code:"MPS"},"Troponin T, Rapid Card Test":{price:590,code:"TRT"},"VDRL - RPR Titre (Semi Quant.) Test":{price:150,code:"VRT"},"Fungal Stain Test":{price:260,code:"FST"},"Phosphorus Test":{price:130,code:"PHT"},"Chloride Test":{price:120,code:"CLT"},"Lactate Dehydrogenase (LDH) Fluid Test":{price:350,code:"LDF"},"Culture Aerobic, Throat Swab Test":{price:700,code:"CTS"},"Culture Aerobic Tissue Test":{price:700,code:"CAT"},"Culture Aerobic, Sputum Test":{price:700,code:"CST"},"Culture Aerobic ET Secretion/Aspirate Test":{price:700,code:"CES"},"Culture Aerobic Eye Swab Test":{price:700,code:"CES"},"Culture Aerobic Pus Test":{price:700,code:"CPT"},"PSA Test":{price:700,code:"PSA"},"Culture Aerobic Ear Swab Test":{price:700,code:"CES"},"Culture Aerobic Body Fluid Test":{price:700,code:"CBF"},"Culture Aerobic Test CSF":{price:700,code:"CAC"},"Culture Aerobic Vaginal Swab Test":{price:700,code:"CVS"},"Culture Aerobic Swab Test":{price:700,code:"CST"},"Culture Aerobic Tip Test":{price:700,code:"CTT"},"Culture Aerobic Semen Test":{price:700,code:"CST"},"HIV Early Screen Test":{price:790,code:"HES"},"Glucose Tolerance Test (GTT 2)":{price:440,code:"GT2"},"Luteinizing Hormone (LH) Test":{price:440,code:"LHT"},"Urea Nitrogen 24 Hrs Urine Test":{price:440,code:"UNU"},"Calcium 24 Hrs Urine Test":{price:440,code:"CUT"},"Creatinine 24 Hrs Urine Test":{price:440,code:"CUT"},"Creatinine Clearance 24 Hrs Urine Test":{price:440,code:"CCU"},"Sodium 24 Hrs Urine Test":{price:440,code:"SUT"},"Phosphorus 24 Hrs Urine Test":{price:440,code:"PUT"},"Indirect Coombs (ICT) Serum Test":{price:440,code:"ICT"},"Albumin Quantitative Urine 24 Hr Test":{price:440,code:"AQU"},"Activated Partial Thromboplastin Time (APTT) Test":{price:440,code:"APT"},"Uric Acid 24 Hrs Urine Test":{price:440,code:"UAU"},"Potassium 24 Hrs Urine Test":{price:440,code:"PKU"},"HCG Maternal Marker (Pregnancy) Test":{price:440,code:"HMP"},"Protein 24 Hrs Urine Test":{price:440,code:"PUH"},"Dengue Duo Screening Test":{price:960,code:"DDS"},"Gestational Glucose Tolerance (GTT 4) Test":{price:870,code:"GGT"},"Non Alcoholic Fatty Liver Disease (NAFLD) Fibrosis Score Test":{price:880,code:"NFS"},"Chikungunya IgM, Rapid Card Test":{price:880,code:"CRT"},"Filaria Antigen Detection Test":{price:880,code:"FAD"},"Testosterone Free Test":{price:1310,code:"TFT"},"8 Profile: 60 Parameters":{price:750,code:"P8_60"},"10 Profile: 85 Parameters":{price:1250,code:"P10_85"},"13 Profile: 95 Parameters":{price:1750,code:"P13_95"},"Award - Male":{price:3250,code:"AWD_M"},"Award - Female":{price:3250,code:"AWD_F"},"Executive - Male":{price:4150,code:"EXE_M"},"Executive - Female":{price:4950,code:"EXE_F"},"Officer - Male":{price:5250,code:"OFF_M"},"Officer - Female":{price:6250,code:"OFF_F"}},ke=["AISSHPRA","APGVB","APGVB Pensioners Association","ASA International","Assam Gramin Vikash Bank","Adhikosh Financial Advisory Pvt Ltd","Adi Chitragupta Finance Limited","Agora Microfinance","Aishwarya MACC Society Ltd","Ambitions Services","Annapurna","Arohan Financial Services Limited","Aviral Finance","Baghat Urban Co-op Bank Ltd","Bangia Gramin Vikas Bank","Bank of India","CBC","CCFID","Cashpor","Chhattisgarh Rajya Gramin Bank","DCBS","DULAL NGO","ESAF HEALTH CARE SERVICES PVT LTD","Hirbandh Ramkrishna Sarada Sevashrama","Humana Financial Services","IFFCO Bazar","Indiabulls Housing Finance","Jayam Community Resource Centre","Janakalyan","KBS Local Bank","Kamal Fincap Private Limited","M-INSURE CHANNEL","Muthoot","Maddox Consultancy Services Pvt Ltd","Madhyanchal Gramin Bank","Maharashtra Gramin Bank","Midland Microfin","Mitrata","Muthoot Capital","NABFINS Limited","Namra Finance","North East Small Finance Bank","North East Small Finance Bank - SHG","Pahal Finance","Panchawati","Paschim Banga Gramin Bank","People's Forum","Projects","Pune District Central Co-op bank","Rohtak Central Cooperative Bank","SEBA RAHARA","Sampurna Training and Entrepreneurship Programme","Sarala Development & Microfinance Pvt Ltd","Satya Microcapital","Servitium Micro Finance Pvt Ltd","Share India Fincap","Shepays Financial Services Pvt Ltd","Sindhuja Microcredit","Sonata Finance","South India Finvest Pvt Ltd","Sudhir HUF","Sugamya","Svatantra","Swabhimaan Sales & Services Pvt Ltd","Swarnodhayam Credits Pvt Ltd","TATA Capital","Utkarsh SFB","Uttar Banga Kshetriya Garmin Bank","Uttar Bihar Gramin Bank","Uttrayan","VFS"],Be=({testCatalog:x,onTestSelect:b,disabled:d,value:y})=>{const[h,t]=a.useState(""),[r,T]=a.useState(!1),[j,C]=a.useState([]),[v,f]=a.useState(!1),n=a.useRef(null);a.useEffect(()=>{const u=i=>{n.current&&!n.current.contains(i.target)&&(T(!1),h||f(!1))};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[h]),a.useEffect(()=>{if(h.trim()){const u=Object.keys(x).filter(i=>i.toLowerCase().includes(h.toLowerCase()));C(u),T(!0)}else C([]),T(!1)},[h,x]);const N=u=>{b(u),t(""),T(!1),f(!1)},s=()=>{f(!0),t("")},S=u=>{t(u.target.value),f(!0)};return e.jsxs("div",{className:"relative",ref:n,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search for a test...",value:v?h:y||"",onChange:S,onFocus:s,className:"w-full h-8 pr-10 border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",disabled:d}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx(ie,{className:"w-4 h-4 text-gray-400"})})]}),r&&!d&&j.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-md shadow-lg border border-gray-200 max-h-48 overflow-y-auto",children:j.map(u=>e.jsxs("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-50 flex justify-between items-center",onClick:()=>N(u),children:[e.jsx("span",{children:u}),e.jsxs("span",{className:"text-sm text-gray-500",children:["₹",x[u].price]})]},u))})]})};function Ue(){const x=xe(),{currentUser:b}=Q(),[d,y]=a.useState(!1),[h,t]=a.useState(""),[r,T]=a.useState(""),[j,C]=a.useState(null),[v,f]=a.useState(!1),[n,N]=a.useState(!1),[s,S]=a.useState(!1),[u,i]=a.useState([]),[I,A]=a.useState(!1),[p,w]=a.useState(!1),[P,B]=a.useState("");a.useEffect(()=>{const l=m=>{m.target.closest(".partner-dropdown")||w(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const o=l=>{R(m=>({...m,partnerName:l})),B(l),w(!1)},[g,E]=a.useState([]);a.useEffect(()=>{const l=V(H,"testEntries"),m=K(l,F=>{try{if(F.exists()){const U=F.val(),L=Object.entries(U).map(([k,Y])=>({id:k,...Y})).sort((k,Y)=>{var de,oe;return new Date(((de=Y.metadata)==null?void 0:de.createdAt)||0)-new Date(((oe=k.metadata)==null?void 0:oe.createdAt)||0)});E(L)}else E([])}catch(U){console.error("Error processing test entries:",U)}},F=>{console.error("Error fetching test entries:",F)});return()=>{J(l,"value",m)}},[]),a.useEffect(()=>{if(r.trim()){const l=g.filter(m=>m.testCode&&m.testCode.toLowerCase().includes(r.toLowerCase())||m.name&&m.name.toLowerCase().includes(r.toLowerCase())||m.bookingId&&m.bookingId.toLowerCase().includes(r.toLowerCase()));i(l.slice(0,5)),A(!0)}else i([]),A(!1)},[r,g]);const G=l=>{R(l),C(l.id),T(l.testCode),A(!1),l.paymentStatus==="completed"?(S(!0),N(!1)):(N(!0),S(!1)),f(!1)},O=l=>{var L;const m=((L=re[l])==null?void 0:L.code)||"TEST",F=Date.now().toString(36),U=Math.random().toString(36).substring(2,5);return`${m}-${F}-${U}`.toUpperCase()},M={name:"",mobileNo:"",age:"",gender:"",district:"",state:"",pincode:"",city:"",address:"",testCode:"",testName:"",price:"",bookingId:"",hasPartner:!1,partnerName:"",partnerReferenceId:"",paymentMode:"",paymentReference:"",paymentStatus:"pending",isFree:!1},[c,R]=a.useState(M),q=l=>{if(!n&&!s){const m=O(l);R(F=>{var U;return{...F,testName:l,testCode:m,price:((U=re[l])==null?void 0:U.price)||"",bookingId:`BK-${m}`}})}},ge=l=>{R(l),C(l.id),T(l.testCode),A(!1),l.paymentStatus==="completed"?(S(!0),N(!1)):(N(!0),S(!1)),f(!1)},D=l=>{const{name:m,value:F,type:U,checked:L}=l.target;s||n&&!["paymentMode","paymentReference","paymentStatus","isFree"].includes(m)||R(m==="hasPartner"?k=>({...k,hasPartner:L,partnerName:"",partnerReferenceId:""}):m==="isFree"?k=>({...k,isFree:L,paymentMode:L?"free":"",paymentStatus:L?"completed":"pending",paymentReference:L?"FREE":""}):m==="paymentMode"?k=>({...k,[m]:F,paymentReference:F==="cash"?"N/A":k.paymentReference}):k=>({...k,[m]:F}))},fe=async()=>{if(!r.trim()){t("Please enter a test code to search");return}y(!0),t("");const l=g.find(m=>m.testCode&&m.testCode.toUpperCase()===r.toUpperCase());l?(R(l),C(l.id),l.paymentStatus==="completed"?(S(!0),N(!1)):(N(!0),S(!1)),f(!1)):t("No entry found with this test code"),y(!1)},be=async l=>{l.preventDefault(),y(!0),t("");try{if(n){const m=V(H,`testEntries/${j}`),F={paymentMode:c.paymentMode,paymentReference:c.paymentReference,paymentStatus:c.paymentStatus,metadata:{...c.metadata,lastModified:new Date().toISOString()}};await ce(m,F),alert("Payment details updated successfully!"),c.paymentStatus==="completed"&&(S(!0),N(!1))}else{const F=["name","mobileNo","age","gender","address","testName"].filter(L=>!c[L]);if(F.length>0){t(`Please fill in all required fields: ${F.join(", ")}`),y(!1);return}const U=V(H,"testEntries");await Fe(U,{...c,submitter:{email:b.email,uid:b.uid,submittedAt:new Date().toISOString()},metadata:{createdAt:new Date().toISOString(),lastModified:new Date().toISOString(),status:"active"}}),alert("Test entry submitted successfully!")}s||(X(),x("/individual-health-camp"))}catch(m){t(`Failed to ${n?"update":"submit"} data: ${m.message}`)}y(!1)},X=()=>{R(M),C(null),N(!1),S(!1),f(!1),T(""),t(""),A(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white to-white py-12 px-4 sm:px-6",children:e.jsxs("div",{className:"max-w-9xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx(le,{activeContext:"test-entry",onTestClick:G})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-8 py-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s?e.jsx(je,{className:"w-7 h-7 text-blue-100"}):n?e.jsx(_,{className:"w-7 h-7 text-blue-100"}):e.jsx(z,{className:"w-7 h-7 text-blue-100"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:s?"View Test Entry":n?"Edit Payment Details":"Test Entry Form"})]}),!n&&!s&&e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsx("button",{type:"button",onClick:()=>f(!v),className:"flex items-center gap-2 px-5 py-2.5 bg-white/10 rounded-lg text-white hover:bg-white/20 transition-colors duration-200 w-full md:w-auto justify-center",children:v?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-5 h-5"}),"New Entry"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-5 h-5"}),"Search Entry"]})}),v&&e.jsx(ne,{testEntries:g,onSearch:fe,onSelect:ge,loading:d})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:[h&&e.jsx("div",{className:"mx-8 mt-6 bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-700",children:h})]})}),e.jsxs("form",{onSubmit:be,className:"p-8 space-y-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-200",children:[e.jsx(W,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Patient Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",name:"name",placeholder:"Enter patient's full name",value:c.name,onChange:D,className:"w-full  border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Mobile Number"}),e.jsx("input",{type:"tel",name:"mobileNo",placeholder:"Enter mobile number",value:c.mobileNo,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Age"}),e.jsx("input",{type:"number",name:"age",placeholder:"Enter age",value:c.age,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Gender"}),e.jsxs("select",{name:"gender",value:c.gender,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Address"}),e.jsx("textarea",{name:"address",placeholder:"Enter complete address",value:c.address,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",rows:3,disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",name:"city",placeholder:"Enter city",value:c.city,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"District"}),e.jsx("input",{type:"text",name:"district",placeholder:"Enter district",value:c.district,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"State"}),e.jsx("input",{type:"text",name:"state",placeholder:"Enter state",value:c.state,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",placeholder:"Enter 6-digit pincode",value:c.pincode,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",maxLength:"6",pattern:"[0-9]{6}",disabled:n||s,required:!0})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-200",children:[e.jsx(_,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Test Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Test Name"}),e.jsx(Be,{testCatalog:re,onTestSelect:q,disabled:n||s,value:c.testName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Test Code"}),e.jsx("input",{type:"text",value:c.testCode,className:"w-full h-12 border-gray-300 bg-gray-50",readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Booking ID"}),e.jsx("input",{type:"text",value:c.bookingId,className:"w-full h-12 border-gray-300 bg-gray-50",readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Price (₹)"}),e.jsx("input",{type:"number",value:c.price,className:"w-full h-12 border-gray-300 bg-gray-50",readOnly:!0})]})]})]}),!s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-200",children:[e.jsx(W,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Partner Details"}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",name:"hasPartner",checked:c.hasPartner,onChange:D,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:n||s}),"Include Partner Details"]})]})]}),c.hasPartner&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2 relative partner-dropdown",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Partner Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"partnerName",placeholder:"Search partner...",value:P,onChange:l=>{B(l.target.value),w(!0)},onClick:()=>w(!0),className:"w-full h-12 border-gray-300 focus:border-blue-500 focus:ring-blue-500 pr-10",disabled:n||s}),e.jsx(ue,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 cursor-pointer",onClick:()=>w(!p)})]}),p&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-48 overflow-y-auto",children:ke.filter(l=>l.toLowerCase().includes(P.toLowerCase())).map((l,m)=>e.jsx("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-50",onClick:()=>o(l),children:l},m))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Subscription ID"}),e.jsx("input",{type:"text",name:"partnerReferenceId",placeholder:"Enter reference ID",value:c.partnerReferenceId,onChange:D,className:"w-full h-12 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:n||s})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-200",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Payment Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-2 md:col-span-2",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isFree",checked:c.isFree,onChange:D,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:s||n&&!c.isFree}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Free Test"})]}),n&&!c.isFree&&e.jsx("span",{className:"text-sm text-gray-500 italic",children:"(Cannot change to free after paid entry submission)"})]})}),!c.isFree&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Payment Mode"}),e.jsxs("select",{name:"paymentMode",value:c.paymentMode,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:s||c.isFree,children:[e.jsx("option",{value:"",children:"Select Payment Mode"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"upi",children:"PrePaid"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Payment Reference"}),e.jsx("input",{type:"text",name:"paymentReference",placeholder:"Enter payment reference",value:c.paymentReference,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:s||c.isFree})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Payment Status"}),e.jsxs("select",{name:"paymentStatus",value:c.paymentStatus,onChange:D,className:"w-full h-8 border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:s||c.isFree,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Status:"}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium
              ${c.paymentStatus==="completed"?"bg-green-100 text-green-700":c.paymentStatus==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:[c.paymentStatus==="completed"?e.jsx(Ne,{className:"w-4 h-4"}):c.paymentStatus==="failed"?e.jsx(Se,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"}),c.paymentStatus.charAt(0).toUpperCase()+c.paymentStatus.slice(1)]})]})})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-4 pt-8 border-t border-gray-200",children:[!s&&e.jsx("button",{type:"button",onClick:X,className:"px-6 py-2.5 rounded-lg text-gray-700 bg-gray-100 hover:bg-gray-200 transition-colors duration-200",children:n?"New Entry":"Reset Form"}),!s&&e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Processing..."]}):n?"Update Payment":"Submit Entry"}),s&&e.jsxs("button",{type:"button",onClick:X,className:"px-6 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"New Entry"]})]})]})]})]})})}function Ie(){const{currentUser:x}=Q(),[b,d]=a.useState(!1),[y,h]=a.useState(""),[t,r]=a.useState(null),[T,j]=a.useState(null),[C,v]=a.useState(""),[f,n]=a.useState("not_completed"),[N,s]=a.useState([]);a.useEffect(()=>{const p=V(H,"testEntries"),w=K(p,P=>{try{if(P.exists()){const B=P.val(),o=Object.entries(B).map(([g,E])=>({id:g,...E})).sort((g,E)=>{var G,O;return new Date(((G=E.metadata)==null?void 0:G.createdAt)||0)-new Date(((O=g.metadata)==null?void 0:O.createdAt)||0)});if(s(o),T){const g=o.find(E=>E.id===T);g&&(r(g),n(g.vendorStatus||"not_completed"),v(g.vendorBookingId||""))}}else s([])}catch(B){console.error("Error processing test entries:",B)}},P=>{console.error("Error fetching test entries:",P)});return()=>{J(p,"value",w)}},[T]);const S=async p=>{if(!p.trim()){h("Please enter a test code");return}d(!0),h("");const w=N.find(P=>P.testCode&&P.testCode.toUpperCase()===p.toUpperCase());w?(r(w),j(w.id),n(w.vendorStatus||"not_completed"),v(w.vendorBookingId||"")):(h("No entry found with this test code"),r(null),j(null)),d(!1)},u=p=>{r(p),j(p.id),n(p.vendorStatus||"not_completed"),v(p.vendorBookingId||"")},i=p=>{r(p),j(p.id),n(p.vendorStatus||"not_completed"),v(p.vendorBookingId||""),h("")},I=async()=>{if(T){if(!t.paymentStatus||t.paymentStatus!=="completed"){h("Cannot update vendor status until payment is completed");return}if(f==="completed"&&!C.trim()){h("Please enter vendor booking ID");return}d(!0),h("");try{const p=V(H,`testEntries/${T}`),w=new Date().toISOString(),P={vendorStatus:f,...f==="completed"&&{vendorBookingId:C},metadata:{...t.metadata,lastModified:w,vendorStatusUpdatedAt:w,vendorStatusUpdatedBy:x.email}};await ce(p,P),alert("Vendor status updated successfully!")}catch(p){h("Failed to update vendor status: "+p.message)}d(!1)}},A=()=>{r(null),j(null),v(""),n("not_completed"),h("")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white to-white px-8 py-8",children:e.jsxs("div",{className:"max-w-8xl mx-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx(le,{activeContext:"vendor-check",onTestClick:i})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Vendor Check"}),e.jsx(ne,{testEntries:N,onSearch:S,onSelect:u,loading:b})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[y&&e.jsx("div",{className:"mx-6 mt-6 bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700",children:y})]})}),t&&e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Patient Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:t.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Mobile"}),e.jsx("p",{className:"font-medium",children:t.mobileNo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Age"}),e.jsx("p",{className:"font-medium",children:t.age})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-medium",children:t.gender})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("p",{className:"font-medium",children:t.address})]})]})]}),t.hasPartner&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Partner Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Partner Name"}),e.jsx("p",{className:"font-medium",children:t.partnerName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Partner Reference ID"}),e.jsx("p",{className:"font-medium",children:t.partnerReferenceId})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Test Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Test Name"}),e.jsx("p",{className:"font-medium",children:t.testName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Test Code"}),e.jsx("p",{className:"font-medium",children:t.testCode})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Booking ID"}),e.jsx("p",{className:"font-medium",children:t.bookingId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["₹",t.price]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Payment Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Payment Mode"}),e.jsx("p",{className:"font-medium capitalize",children:t.paymentMode||"Not Set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Payment Reference"}),e.jsx("p",{className:"font-medium",children:t.paymentReference||"Not Set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Payment Status"}),e.jsx("p",{className:`font-medium capitalize ${t.paymentStatus==="completed"?"text-green-600":t.paymentStatus==="failed"?"text-red-600":"text-yellow-600"}`,children:t.paymentStatus||"Pending"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vendor Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("select",{value:f,onChange:p=>n(p.target.value),className:"rounded-lg border-gray-300",disabled:t.vendorStatus==="completed"||t.paymentStatus!=="completed",children:[e.jsx("option",{value:"not_completed",children:"Not Completed"}),e.jsx("option",{value:"completed",children:"Completed"})]}),f==="completed"&&e.jsx("input",{type:"text",value:C,onChange:p=>v(p.target.value),placeholder:"Enter Vendor Booking ID",className:"rounded-lg border-gray-300",disabled:t.vendorStatus==="completed"||t.paymentStatus!=="completed",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:A,className:"px-6 py-2 rounded-lg text-gray-700 bg-gray-100 hover:bg-gray-200",children:"Clear"}),t.vendorStatus!=="completed"&&t.paymentStatus==="completed"&&e.jsx("button",{onClick:I,disabled:b,className:"px-6 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:b?"Processing...":"Update Vendor Status"})]})]})]})]})})}function Me(){const[x,b]=a.useState(""),[d,y]=a.useState(!1),[h,t]=a.useState(""),[r,T]=a.useState(null),[j,C]=a.useState(null),[v,f]=a.useState("not_submitted"),[n,N]=a.useState(!1),[s,S]=a.useState([]),[u,i]=a.useState([]),{currentUser:I}=Q();a.useEffect(()=>{const o=V(H,"testEntries"),g=K(o,E=>{try{if(E.exists()){const G=E.val(),O=Object.entries(G).map(([M,c])=>({id:M,...c})).sort((M,c)=>{var R,q;return new Date(((R=c.metadata)==null?void 0:R.createdAt)||0)-new Date(((q=M.metadata)==null?void 0:q.createdAt)||0)});if(i(O),j){const M=O.find(c=>c.id===j);M&&(T(M),f(M.reportStatus||"not_submitted"))}}else i([])}catch(G){console.error("Error processing test entries:",G)}},E=>{console.error("Error fetching test entries:",E)});return()=>{J(o,"value",g)}},[j]),a.useEffect(()=>{if(x.trim()){const o=u.filter(g=>g.testCode&&g.testCode.toLowerCase().includes(x.toLowerCase())||g.name&&g.name.toLowerCase().includes(x.toLowerCase())||g.bookingId&&g.bookingId.toLowerCase().includes(x.toLowerCase()));S(o.slice(0,5)),N(!0)}else S([]),N(!1)},[x,u]);const A=o=>{b(o.testCode),T(o),C(o.id),f(o.reportStatus||"not_submitted"),N(!1),t("")},p=o=>{b(o.testCode),T(o),C(o.id),f(o.reportStatus||"not_submitted"),N(!1)},w=()=>{if(!x.trim()){t("Please enter a test code");return}y(!0),t("");try{const o=u.find(g=>g.testCode&&g.testCode.toUpperCase()===x.toUpperCase());o?(T(o),C(o.id),f(o.reportStatus||"not_submitted")):(t("No entry found with this test code"),T(null),C(null))}catch(o){t("Error searching for test entry: "+o.message)}y(!1)},P=async()=>{if(j){if(!r.vendorStatus||r.vendorStatus!=="completed"){t("Cannot update report status until vendor check is completed");return}y(!0),t("");try{const o=V(H,`testEntries/${j}`),g=new Date().toISOString(),E={reportStatus:v,metadata:{...r.metadata,lastModified:g,reportStatusUpdatedAt:g,reportStatusUpdatedBy:I.email}};await ce(o,E),alert("Report status updated successfully!")}catch(o){t("Failed to update report status: "+o.message)}y(!1)}},B=()=>{b(""),T(null),C(null),f("not_submitted"),t(""),N(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white to-white px-8 py-8 ",children:e.jsxs("div",{className:"max-w-10xl mx-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx(le,{activeContext:"report-status",onTestClick:A})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-8 ",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Report Status"}),e.jsx(ne,{testEntries:u,onSearch:w,onSelect:p,loading:d})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[h&&e.jsx("div",{className:"mx-6 mt-6 bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700",children:h})]})}),r&&e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Patient Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:r.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Mobile"}),e.jsx("p",{className:"font-medium",children:r.mobileNo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Age"}),e.jsx("p",{className:"font-medium",children:r.age})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-medium",children:r.gender})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("p",{className:"font-medium",children:r.address})]})]})]}),r.hasPartner&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Partner Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Partner Name"}),e.jsx("p",{className:"font-medium",children:r.partnerName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Partner Reference ID"}),e.jsx("p",{className:"font-medium",children:r.partnerReferenceId})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Test Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Test Name"}),e.jsx("p",{className:"font-medium",children:r.testName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Test Code"}),e.jsx("p",{className:"font-medium",children:r.testCode})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Booking ID"}),e.jsx("p",{className:"font-medium",children:r.bookingId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["₹",r.price]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vendor Status"}),e.jsx("p",{className:"font-medium capitalize",children:r.vendorStatus||"Not Completed"})]}),r.vendorBookingId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vendor Booking ID"}),e.jsx("p",{className:"font-medium",children:r.vendorBookingId})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Report Status"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("select",{value:v,onChange:o=>f(o.target.value),className:"rounded-lg border-gray-300",disabled:r.reportStatus==="submitted"||!r.vendorStatus||r.vendorStatus!=="completed",children:[e.jsx("option",{value:"not_submitted",children:"Not Sent"}),e.jsx("option",{value:"submitted",children:"Sent"})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:B,className:"px-6 py-2 rounded-lg text-gray-700 bg-gray-100 hover:bg-gray-200",children:"Clear"}),(!r.reportStatus||r.reportStatus!=="submitted")&&r.vendorStatus==="completed"&&e.jsx("button",{onClick:P,disabled:d,className:"px-6 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:d?"Processing...":"Update Report Status"})]})]})]})]})})}const $e=()=>{xe();const[x,b]=a.useState("test-entry"),{currentUser:d}=Q(),y=(d==null?void 0:d.role)==="individual-camp-admin",h=[{id:"test-entry",name:"Test Entry",component:Ue,icon:me,description:"Record and manage test results",restricted:!1},{id:"vendor-check",name:"Vendor Booking",component:Ie,icon:pe,description:"Verify and manage vendors",restricted:y},{id:"report-status",name:"Report Status",component:Me,icon:Pe,description:"Track report generation progress",restricted:y}];return ve.useEffect(()=>{var t;(t=h.find(r=>r.id===x))!=null&&t.restricted&&b("test-entry")},[x]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-100",children:[e.jsx("header",{className:"bg-gradient-to-r from-blue-700 to-indigo-800 px-8 py-6 shadow-xl",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/15 rounded-xl backdrop-blur-sm",children:e.jsx(me,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:"Test Management System"}),e.jsx("p",{className:"text-blue-100 text-sm mt-1.5",children:"Streamlined healthcare test management"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 rounded-lg px-4 py-2.5 backdrop-blur-sm",children:[e.jsx(z,{className:"w-5 h-5 text-white"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"text-sm font-medium text-white",children:d==null?void 0:d.email})})]})})]})})}),e.jsx("main",{className:"px-6 py-8",children:e.jsx("div",{className:"max-w-9xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:[e.jsxs("div",{className:"px-8 py-4 border-b border-gray-100 flex items-center space-x-2 text-sm bg-gray-50/50",children:[e.jsx("span",{className:"text-gray-600",children:"Dashboard"}),e.jsx(we,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-blue-600 font-medium",children:"Test Management"})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 bg-gray-50 p-3 rounded-xl",children:h.map(t=>e.jsxs("button",{onClick:()=>!t.restricted&&b(t.id),disabled:t.restricted,className:`
                      relative flex flex-col items-center
                      rounded-xl py-4 px-6
                      transition-all duration-300 ease-out
                      ${t.restricted?"opacity-50 cursor-not-allowed":""}
                      ${x===t.id?"bg-white shadow-lg ring-2 ring-blue-600/10 scale-100":"hover:bg-white/80 hover:shadow-md hover:scale-102"}
                    `,children:[e.jsxs("div",{className:`
                      p-3 rounded-xl relative
                      transition-colors duration-200
                      ${x===t.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600"}
                    `,children:[e.jsx(t.icon,{className:"w-6 h-6"}),t.restricted&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-white rounded-full p-1 shadow-sm",children:e.jsx(Ae,{className:"w-3 h-3 text-gray-500"})})]}),e.jsxs("div",{className:"text-center mt-3",children:[e.jsx("div",{className:`
                        font-medium text-base
                        ${x===t.id?"text-blue-600":"text-gray-700"}
                      `,children:t.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1.5 max-w-xs",children:t.restricted?"Access restricted":t.description})]})]},t.id))}),e.jsx("div",{className:"mt-8",children:h.map(t=>e.jsx("div",{className:`
                      transform transition-all duration-500 ease-in-out
                      ${x===t.id?"opacity-100 translate-y-0":"opacity-0 translate-y-4 hidden"}
                    `,children:e.jsx("div",{className:"bg-white rounded-xl p-8 ring-1 ring-gray-100 shadow-sm",children:e.jsx(t.component,{})})},t.id))})]})]})})})]})};export{$e as default};
